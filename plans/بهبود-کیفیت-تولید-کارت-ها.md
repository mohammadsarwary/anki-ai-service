# Ù¾Ù„Ù† Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ: Ø¨Ù‡Ø¨ÙˆØ¯ Ú©ÛŒÙÛŒØª ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¨Ø§ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø¨ÛŒØ´ØªØ±

## ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ù¾Ø±ÙˆÚ˜Ù‡

Ø§ÛŒÙ† Ù¾Ù„Ù† Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Anki Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù‡Ø¯Ù Ø§ØµÙ„ÛŒ Ø§ÛŒÙ† Ø§Ø³Øª Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨ØªÙˆØ§Ù†Ù†Ø¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø±Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù…Ø·Ø§Ø¨Ù‚ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø®ÙˆØ¯ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†Ù†Ø¯.

---

## ğŸ¯ Ø§Ù‡Ø¯Ø§Ù Ø§ØµÙ„ÛŒ

1. **Ø§ÙØ²ÙˆØ¯Ù† Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø¨Ú© Ú©Ø§Ø±Øª**: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø³Ø¨Ú© Ú©Ø§Ø±Øª Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†Ù†Ø¯ (Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„ØŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ØŒ Ø¬Ø§Ù…Ø¹ØŒ Ù…Ú©Ø§Ù„Ù…Ù‡â€ŒØ§ÛŒ)
2. **ØªÙ†Ø¸ÛŒÙ… ØªØ¹Ø¯Ø§Ø¯ Ùˆ Ù†ÙˆØ¹ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§**: Ú©Ù†ØªØ±Ù„ Ø¨Ø± ØªØ¹Ø¯Ø§Ø¯ Ùˆ Ø³Ø¨Ú© Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ (Ø±Ø³Ù…ÛŒØŒ ØºÛŒØ±Ø±Ø³Ù…ÛŒØŒ Ø®Ù†Ø«ÛŒ)
3. **Ø§ÙØ²ÙˆØ¯Ù† Ø²Ù…ÛŒÙ†Ù‡ Ùˆ Ø¨Ø§ÙØª**: Ø§Ù…Ú©Ø§Ù† ØªØ¹ÛŒÛŒÙ† Ø²Ù…ÛŒÙ†Ù‡ Ø®Ø§Øµ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª (Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±ØŒ Ù¾Ø²Ø´Ú©ÛŒØŒ Ø±ÙˆØ²Ù…Ø±Ù‡ Ùˆ ØºÛŒØ±Ù‡)
4. **ØªÙ†Ø¸ÛŒÙ… Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ¹Ø±ÛŒÙ**: Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª (Ù¾Ø§ÛŒÙ‡ØŒ Ø¯Ù‚ÛŒÙ‚ØŒ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ©)
5. **ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ CardBack**: Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ØŒ Ù…ØªØ¶Ø§Ø¯Ù‡Ø§ØŒ Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒØŒ Ø¹Ø¨Ø§Ø±Ø§Øª Ø±Ø§ÛŒØ¬ Ùˆ Ø§ØµØ·Ù„Ø§Ø­Ø§Øª

---

## ğŸ“Š Ù…Ø¹Ù…Ø§Ø±ÛŒ ÙØ¹Ù„ÛŒ

```mermaid
graph TD
    A[Ø¯Ø±Ø®ÙˆØ§Ø³Øª API] --> B[API Layer - cards.py]
    B --> C[Service Layer - card_generation_service.py]
    C --> D[Provider Layer - openrouter.py]
    D --> E[AI Provider API]
    E --> D
    D --> C
    C --> B
    B --> F[Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#f5e1ff
    style F fill:#e1f5ff
```

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ ÙØ¹Ù„ÛŒ

| ÙØ§ÛŒÙ„ | Ù†Ù‚Ø´ | ØªÙˆØ¶ÛŒØ­Ø§Øª |
|------|------|---------|
| [`ai_service/app/models/request.py`](ai_service/app/models/request.py:1) | Ù…Ø¯Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª | ØªØ¹Ø±ÛŒÙ [`CardGenerationRequest`](ai_service/app/models/request.py:23) Ùˆ [`CardGenerationFromTopicRequest`](ai_service/app/models/request.py:53) |
| [`ai_service/app/models/response.py`](ai_service/app/models/response.py:1) | Ù…Ø¯Ù„ Ù¾Ø§Ø³Ø® | ØªØ¹Ø±ÛŒÙ [`CardGenerationResponse`](ai_service/app/models/response.py:108) Ùˆ [`CardBack`](ai_service/app/models/response.py:73) |
| [`ai_service/app/services/card_generation_service.py`](ai_service/app/services/card_generation_service.py:1) | Ø³Ø±ÙˆÛŒØ³ | Ù„Ø§ÛŒÙ‡ Ø³Ø±ÙˆÛŒØ³ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª |
| [`ai_service/app/providers/openrouter.py`](ai_service/app/providers/openrouter.py:1) | Ø§Ø±Ø§Ø¦Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡ AI | Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ OpenRouter Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª |
| [`ai_service/app/api/v1/cards.py`](ai_service/app/api/v1/cards.py:1) | API | ØªØ¹Ø±ÛŒÙ Ù…Ø³ÛŒØ±Ù‡Ø§ÛŒ API |
| [`ai_service/app/core/config.py`](ai_service/app/core/config.py:1) | ØªÙ†Ø¸ÛŒÙ…Ø§Øª | ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø±Ù†Ø§Ù…Ù‡ |

---

## ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

```mermaid
graph TD
    A[Ø¯Ø±Ø®ÙˆØ§Ø³Øª API Ø¨Ø§ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯] --> B[API Layer - cards.py]
    B --> C{Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª}
    C -->|Ù…Ø¹ØªØ¨Ø±| D[Service Layer - card_generation_service.py]
    C -->|Ù†Ø§Ù…Ø¹ØªØ¨Ø±| E[Ø®Ø·Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ]
    
    D --> F[Provider Layer - openrouter.py]
    F --> G[Ø³Ø§Ø®Øª Ù¾Ø±Ø§Ù…Ù¾Øª Ù¾ÙˆÛŒØ§]
    G --> H{Ø³Ø¨Ú© Ú©Ø§Ø±Øª}
    
    H -->|minimal| I[Ù¾Ø±Ø§Ù…Ù¾Øª Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„]
    H -->|standard| J[Ù¾Ø±Ø§Ù…Ù¾Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯]
    H -->|comprehensive| K[Ù¾Ø±Ø§Ù…Ù¾Øª Ø¬Ø§Ù…Ø¹]
    H -->|conversational| L[Ù¾Ø±Ø§Ù…Ù¾Øª Ù…Ú©Ø§Ù„Ù…Ù‡â€ŒØ§ÛŒ]
    
    I --> M[AI Provider API]
    J --> M
    K --> M
    L --> M
    
    M --> N[Ù¾Ø§Ø³Ø® Ø®Ø§Ù… AI]
    N --> O[Ù¾Ø§Ø±Ø³ÛŒÙ†Ú¯ Ù¾Ø§Ø³Ø®]
    O --> P[Ø³Ø§Ø®Øª Ù…Ø¯Ù„ Ù¾Ø§Ø³Ø®]
    P --> D
    D --> B
    B --> Q[Ù¾Ø§Ø³Ø® Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1e1
    style D fill:#ffe1f5
    style E fill:#ffcccc
    style F fill:#e1ffe1
    style G fill:#f5e1ff
    style M fill:#f5e1ff
    style Q fill:#e1f5ff
```

---

## ğŸ“ Ø¬Ø²Ø¦ÛŒØ§Øª Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

### Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª

#### ÙØ§ÛŒÙ„: [`ai_service/app/models/request.py`](ai_service/app/models/request.py:1)

#### Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† EnumÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:

```python
class CardStyle(str, Enum):
    """Ø³Ø¨Ú© Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª"""
    MINIMAL = "minimal"          # ÙÙ‚Ø· ØªØ¹Ø±ÛŒÙ Ùˆ ÛŒÚ© Ù…Ø«Ø§Ù„ Ø³Ø§Ø¯Ù‡
    STANDARD = "standard"        # ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ ÙØ¹Ù„ÛŒ
    COMPREHENSIVE = "comprehensive"  # ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ + Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ + Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ
    CONVERSATIONAL = "conversational"  # ØªÙ…Ø±Ú©Ø² Ø¨Ø± Ù…Ú©Ø§Ù„Ù…Ù‡ Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±ÙˆØ²Ù…Ø±Ù‡

class ExampleStyle(str, Enum):
    """Ø³Ø¨Ú© Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§"""
    FORMAL = "formal"            # Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø±Ø³Ù…ÛŒ Ùˆ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ©
    INFORMAL = "informal"        # Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø±Ø³Ù…ÛŒ Ùˆ Ù…Ø­Ø§ÙˆØ±Ù‡â€ŒØ§ÛŒ
    NEUTRAL = "neutral"          # Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø®Ù†Ø«ÛŒ Ùˆ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯

class DetailLevel(str, Enum):
    """Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ¹Ø±ÛŒÙ"""
    BASIC = "basic"              # ØªØ¹Ø±ÛŒÙ Ø³Ø§Ø¯Ù‡ Ùˆ Ù…Ø®ØªØµØ±
    DETAILED = "detailed"        # ØªØ¹Ø±ÛŒÙ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±
    ACADEMIC = "academic"        # ØªØ¹Ø±ÛŒÙ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ© Ùˆ ØªØ®ØµØµÛŒ
```

#### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationRequest`](ai_service/app/models/request.py:23):

```python
class CardGenerationRequest(BaseModel):
    """Payload Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø·Ù‡ Ù¾Ø§ÛŒØ§Ù†ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª"""

    term: str = Field(
        ...,
        min_length=1,
        max_length=500,
        description="Ú©Ù„Ù…Ù‡ ÛŒØ§ Ø¹Ø¨Ø§Ø±ØªÛŒ Ú©Ù‡ Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ø¢Ù† ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯.",
        examples=["ephemeral"],
    )
    language: str = Field(
        default="en",
        min_length=2,
        max_length=10,
        description="Ú©Ø¯ Ø²Ø¨Ø§Ù† ISO Ø¨Ø±Ø§ÛŒ Ú©Ù„Ù…Ù‡ Ù…Ù†Ø¨Ø¹.",
        examples=["en"],
    )
    target_language: str = Field(
        default="fa",
        min_length=2,
        max_length=10,
        description="Ú©Ø¯ Ø²Ø¨Ø§Ù† ISO Ø¨Ø±Ø§ÛŒ Ø²Ø¨Ø§Ù† Ù‡Ø¯Ù Ú©Ø§Ø±Øª.",
        examples=["fa"],
    )
    level: Level = Field(
        default=Level.BEGINNER,
        description="Ø³Ø·Ø­ ØªØ³Ù„Ø· Ø²Ø¨Ø§Ù†â€ŒØ¢Ù…ÙˆØ².",
    )
    
    # === Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø¬Ø¯ÛŒØ¯ ===
    
    card_style: CardStyle = Field(
        default=CardStyle.STANDARD,
        description="Ø³Ø¨Ú© Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ú©Ù‡ Ù…ÛŒØ²Ø§Ù† Ø¬Ø²Ø¦ÛŒØ§Øª Ø±Ø§ ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯.",
    )
    
    include_examples: int = Field(
        default=2,
        ge=1,
        le=5,
        description="ØªØ¹Ø¯Ø§Ø¯ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ ØªÙˆÙ„ÛŒØ¯ Ø´ÙˆÙ†Ø¯.",
    )
    
    include_pronunciation: bool = Field(
        default=True,
        description="Ø¢ÛŒØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ„ÙØ¸ Ø´Ø§Ù…Ù„ Ø´ÙˆØ¯ØŸ",
    )
    
    include_memory_tip: bool = Field(
        default=True,
        description="Ø¢ÛŒØ§ Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡ Ø´Ø§Ù…Ù„ Ø´ÙˆØ¯ØŸ",
    )
    
    example_style: ExampleStyle = Field(
        default=ExampleStyle.NEUTRAL,
        description="Ø³Ø¨Ú© Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡.",
    )
    
    definition_depth: DetailLevel = Field(
        default=DetailLevel.BASIC,
        description="Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ¹Ø±ÛŒÙ.",
    )
    
    context: Optional[str] = Field(
        default=None,
        max_length=200,
        description="Ø²Ù…ÛŒÙ†Ù‡ ÛŒØ§ Ù…ÙˆØ¶ÙˆØ¹ Ø®Ø§Øµ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Øª (Ù…Ø«Ù„Ø§Ù‹: business, medical, casual)",
    )
    
    difficulty_adjustment: Optional[str] = Field(
        default=None,
        description="ØªÙ†Ø¸ÛŒÙ… Ø³Ø®ØªÛŒ Ú©Ø§Ø±Øª (easier ÛŒØ§ harder)",
    )
```

#### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationFromTopicRequest`](ai_service/app/models/request.py:53):

```python
class CardGenerationFromTopicRequest(BaseModel):
    """Payload Ø¨Ø±Ø§ÛŒ Ù†Ù‚Ø·Ù‡ Ù¾Ø§ÛŒØ§Ù†ÛŒ ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª Ø§Ø² Ù…ÙˆØ¶ÙˆØ¹"""

    topic: str = Field(
        ...,
        min_length=10,
        max_length=500,
        description="Ù…ÙˆØ¶ÙˆØ¹ÛŒ Ú©Ù‡ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ø¢Ù† ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.",
        examples=["At the end of the day"],
    )

    count: int = Field(
        default=5,
        description="ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ú©Ù‡ Ø¨Ø§ÛŒØ¯ ØªÙˆÙ„ÛŒØ¯ Ø´ÙˆÙ†Ø¯.",
    )

    level: Level = Field(
        default=Level.BEGINNER,
        description="Ø³Ø·Ø­ ØªØ³Ù„Ø· Ø²Ø¨Ø§Ù†â€ŒØ¢Ù…ÙˆØ².",
    )

    language: str = Field(
        default="en",
        min_length=2,
        max_length=10,
        description="Ú©Ø¯ Ø²Ø¨Ø§Ù† ISO Ø¨Ø±Ø§ÛŒ Ú©Ù„Ù…Ù‡ Ù…Ù†Ø¨Ø¹.",
        examples=["en"],
    )
    
    target_language: str = Field(
        default="fa",
        min_length=2,
        max_length=10,
        description="Ú©Ø¯ Ø²Ø¨Ø§Ù† ISO Ø¨Ø±Ø§ÛŒ Ø²Ø¨Ø§Ù† Ù‡Ø¯Ù Ú©Ø§Ø±Øª.",
        examples=["fa"],
    )
    
    # === Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø¬Ø¯ÛŒØ¯ ===
    
    card_style: CardStyle = Field(
        default=CardStyle.STANDARD,
        description="Ø³Ø¨Ú© Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ú©Ù‡ Ù…ÛŒØ²Ø§Ù† Ø¬Ø²Ø¦ÛŒØ§Øª Ø±Ø§ ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯.",
    )
    
    include_examples: int = Field(
        default=2,
        ge=1,
        le=5,
        description="ØªØ¹Ø¯Ø§Ø¯ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ ØªÙˆÙ„ÛŒØ¯ Ø´ÙˆÙ†Ø¯.",
    )
    
    include_pronunciation: bool = Field(
        default=True,
        description="Ø¢ÛŒØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ„ÙØ¸ Ø´Ø§Ù…Ù„ Ø´ÙˆØ¯ØŸ",
    )
    
    include_memory_tip: bool = Field(
        default=True,
        description="Ø¢ÛŒØ§ Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡ Ø´Ø§Ù…Ù„ Ø´ÙˆØ¯ØŸ",
    )
    
    example_style: ExampleStyle = Field(
        default=ExampleStyle.NEUTRAL,
        description="Ø³Ø¨Ú© Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡.",
    )
    
    definition_depth: DetailLevel = Field(
        default=DetailLevel.BASIC,
        description="Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ¹Ø±ÛŒÙ.",
    )
    
    context: Optional[str] = Field(
        default=None,
        max_length=200,
        description="Ø²Ù…ÛŒÙ†Ù‡ ÛŒØ§ Ù…ÙˆØ¶ÙˆØ¹ Ø®Ø§Øµ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ (Ù…Ø«Ù„Ø§Ù‹: business, medical, casual)",
    )
    
    difficulty_adjustment: Optional[str] = Field(
        default=None,
        description="ØªÙ†Ø¸ÛŒÙ… Ø³Ø®ØªÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ (easier ÛŒØ§ harder)",
    )
```

---

### Ù…Ø±Ø­Ù„Ù‡ Û²: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ø³Ø®

#### ÙØ§ÛŒÙ„: [`ai_service/app/models/response.py`](ai_service/app/models/response.py:1)

#### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardBack`](ai_service/app/models/response.py:73):

```python
class CardBack(BaseModel):
    """Ù…Ø­ØªÙˆØ§ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù¾Ø´Øª Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª.
    
    Ø§ÛŒÙ† Ù…Ø¯Ù„ ØªÙ…Ø§Ù… Ù…Ø­ØªÙˆØ§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ú©Ù‡ Ø¯Ø± Ù¾Ø´Øª ÛŒÚ© Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¸Ø§Ù‡Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
    Ø´Ø§Ù…Ù„ ØªØ¹Ø±ÛŒÙØŒ ØªÙ„ÙØ¸ØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ùˆ Ù†Ú©Ø§Øª Ø­Ø§ÙØ¸Ù‡ Ø±Ø§ Ø¯Ø± Ø¨Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯.
    """
    
    definition: str = Field(
        default="",
        description="ØªØ¹Ø±ÛŒÙ Ø§ØµÙ„ÛŒ ÛŒØ§ ØªØ±Ø¬Ù…Ù‡ Ø§ØµØ·Ù„Ø§Ø­.",
    )
    pronunciation: Optional[Pronunciation] = Field(
        default=None,
        description="Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙ„ÙØ¸ Ùˆ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ TTS.",
    )
    part_of_speech: Optional[str] = Field(
        default=None,
        description="Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø³ØªÙˆØ±ÛŒ (Ø§Ø³Ù…ØŒ ÙØ¹Ù„ØŒ ØµÙØª Ùˆ ØºÛŒØ±Ù‡).",
        examples=["noun", "verb", "adjective", "adverb"],
    )
    usage: Optional[str] = Field(
        default=None,
        description="ØªÙˆØ¶ÛŒØ­ Ú©Ø§Ø±Ø¨Ø±Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ú©Ù„Ù…Ù‡.",
    )
    examples: List[Example] = Field(
        default_factory=list,
        description="Ù„ÛŒØ³Øª Ø¬Ù…Ù„Ø§Øª Ù†Ù…ÙˆÙ†Ù‡ Ú©Ù‡ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ù†Ø¯.",
    )
    memory_tip: Optional[str] = Field(
        default=None,
        description="Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡ Ú©ÙˆØªØ§Ù‡ Ùˆ Ù…ÙÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ ÛŒØ§Ø¯ Ø¢ÙˆØ±Ø¯Ù† Ú©Ù„Ù…Ù‡.",
    )
    
    # === ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ ===
    
    synonyms: Optional[List[str]] = Field(
        default=None,
        description="Ù„ÛŒØ³Øª Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ÛŒ Ú©Ù„Ù…Ù‡.",
        examples=["brief", "short-lived", "temporary"],
    )
    
    antonyms: Optional[List[str]] = Field(
        default=None,
        description="Ù„ÛŒØ³Øª Ù…ØªØ¶Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„Ù…Ù‡.",
        examples=["permanent", "lasting", "eternal"],
    )
    
    etymology: Optional[str] = Field(
        default=None,
        description="Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ Ú©Ù„Ù…Ù‡ Ùˆ Ù…Ù†Ø´Ø£ Ø¢Ù†.",
        examples="Ø§Ø² ÛŒÙˆÙ†Ø§Ù†ÛŒ Ø¨Ø§Ø³ØªØ§Ù†: epi- (Ø±ÙˆÛŒ) + hemera (Ø±ÙˆØ²)",
    )
    
    collocations: Optional[List[str]] = Field(
        default=None,
        description="Ø¹Ø¨Ø§Ø±Ø§Øª Ø±Ø§ÛŒØ¬ Ùˆ ØªØ±Ú©ÛŒØ¨Ø§Øª Ø¨Ø§ Ø§ÛŒÙ† Ú©Ù„Ù…Ù‡.",
        examples=["ephemeral beauty", "ephemeral nature", "ephemeral pleasure"],
    )
    
    idioms: Optional[List[str]] = Field(
        default=None,
        description="Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ùˆ Ø¶Ø±Ø¨â€ŒØ§Ù„Ù…Ø«Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ú©Ù„Ù…Ù‡.",
    )
```

---

### Ù…Ø±Ø­Ù„Ù‡ Û³: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³Ø±ÙˆÛŒØ³

#### ÙØ§ÛŒÙ„: [`ai_service/app/services/card_generation_service.py`](ai_service/app/services/card_generation_service.py:1)

```python
# app/services/card_generation_service.py
from app.providers import get_ai_provider
from app.models.response import CardGenerationResponse, CardGenerationFromTopicResponse

class CardGenerationService:
    """Ø³Ø±ÙˆÛŒØ³ÛŒ Ú©Ù‡ Ø¨Ù‡ Ø§Ø±Ø§Ø¦Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ú¯Ø§Ù† AI ØªÙÙˆÛŒØ¶ Ø§Ø®ØªÛŒØ§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯."""
    
    def __init__(self):
        self.provider = get_ai_provider()
    
    async def generate_card(
        self, 
        term: str, 
        language: str, 
        target_language: str, 
        level: str,
        # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
        card_style: str = "standard",
        include_examples: int = 2,
        include_pronunciation: bool = True,
        include_memory_tip: bool = True,
        example_style: str = "neutral",
        definition_depth: str = "basic",
        context: str = None,
        difficulty_adjustment: str = None,
    ) -> CardGenerationResponse:
        return await self.provider.generate_card(
            term=term,
            language=language,
            target_language=target_language,
            level=level,
            card_style=card_style,
            include_examples=include_examples,
            include_pronunciation=include_pronunciation,
            include_memory_tip=include_memory_tip,
            example_style=example_style,
            definition_depth=definition_depth,
            context=context,
            difficulty_adjustment=difficulty_adjustment,
        )
    
    async def generate_card_from_topic(
        self,
        topic: str,
        count: int,
        level: str,
        language: str,
        target_language: str,
        # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
        card_style: str = "standard",
        include_examples: int = 2,
        include_pronunciation: bool = True,
        include_memory_tip: bool = True,
        example_style: str = "neutral",
        definition_depth: str = "basic",
        context: str = None,
        difficulty_adjustment: str = None,
    ) -> CardGenerationFromTopicResponse:
        return await self.provider.generate_cards_from_topic(
            topic=topic,
            count=count,
            level=level,
            language=language,
            target_language=target_language,
            card_style=card_style,
            include_examples=include_examples,
            include_pronunciation=include_pronunciation,
            include_memory_tip=include_memory_tip,
            example_style=example_style,
            definition_depth=definition_depth,
            context=context,
            difficulty_adjustment=difficulty_adjustment,
        )
```

---

### Ù…Ø±Ø­Ù„Ù‡ Û´: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ API

#### ÙØ§ÛŒÙ„: [`ai_service/app/api/v1/cards.py`](ai_service/app/api/v1/cards.py:1)

```python
@router.post(
    "/generate-flashcards",
    response_model=CardGenerationResponse,    
)
async def generate_card(
    request: CardGenerationRequest,
    service:CardGenerationService=Depends(get_card_service),
    user: dict = Depends(get_current_user),
):
    """ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª ÙÙ„Ø´â€ŒÚ©Ø§Ø±Øª Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø´Ø¯Ù‡."""
    logger.info(f"Generating flashcard for user: {user.get('user_id')}")
    
    result = await service.generate_card(
        term=request.term,
        language=request.language,
        target_language=request.target_language,
        level=request.level,
        # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
        card_style=request.card_style,
        include_examples=request.include_examples,
        include_pronunciation=request.include_pronunciation,
        include_memory_tip=request.include_memory_tip,
        example_style=request.example_style,
        definition_depth=request.definition_depth,
        context=request.context,
        difficulty_adjustment=request.difficulty_adjustment,
    )
    return result


@router.post(
    "/generate-from-topic",
    response_model=CardGenerationFromTopicResponse,    
)
async def generate_card_from_topic(
    request: CardGenerationFromTopicRequest,
    service:CardGenerationService=Depends(get_card_service),
    user: dict = Depends(get_current_user),
):
    logger.info(f"Generating flashcard from topic for user: {user.get('user_id')}")
    result = await service.generate_card_from_topic(
        topic=request.topic,
        count=request.count,
        level=request.level,
        language=request.language,
        target_language=request.target_language,
        # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
        card_style=request.card_style,
        include_examples=request.include_examples,
        include_pronunciation=request.include_pronunciation,
        include_memory_tip=request.include_memory_tip,
        example_style=request.example_style,
        definition_depth=request.definition_depth,
        context=request.context,
        difficulty_adjustment=request.difficulty_adjustment,
    )
    return result
```

---

### Ù…Ø±Ø­Ù„Ù‡ Ûµ: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø±Ø§Ø¦Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡ AI

#### ÙØ§ÛŒÙ„: [`ai_service/app/providers/openrouter.py`](ai_service/app/providers/openrouter.py:1)

#### Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª Ù¾Ø±Ø§Ù…Ù¾Øª Ù¾ÙˆÛŒØ§:

```python
def _build_prompt_template(
    card_style: str,
    include_examples: int,
    include_pronunciation: bool,
    include_memory_tip: bool,
    example_style: str,
    definition_depth: str,
    context: str,
    difficulty_adjustment: str,
    target_language: str,
    language: str,
) -> str:
    """Ø³Ø§Ø®Øª Ù‚Ø§Ù„Ø¨ Ù¾Ø±Ø§Ù…Ù¾Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ."""
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ Ø³Ø¨Ú© Ú©Ø§Ø±Øª
    style_instructions = {
        "minimal": "ÙÙ‚Ø· ØªØ¹Ø±ÛŒÙ Ùˆ ÛŒÚ© Ù…Ø«Ø§Ù„ Ø³Ø§Ø¯Ù‡ Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯. Ø¨Ø¯ÙˆÙ† Ø¬Ø²Ø¦ÛŒØ§Øª Ø§Ø¶Ø§ÙÛŒ.",
        "standard": "ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø±Ø§ Ø´Ø§Ù…Ù„ ØªØ¹Ø±ÛŒÙØŒ ØªÙ„ÙØ¸ØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ùˆ Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡ Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.",
        "comprehensive": "Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ø´Ø§Ù…Ù„ Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ØŒ Ù…ØªØ¶Ø§Ø¯Ù‡Ø§ØŒ Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒØŒ Ø¹Ø¨Ø§Ø±Ø§Øª Ø±Ø§ÛŒØ¬ Ùˆ Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.",
        "conversational": "ØªÙ…Ø±Ú©Ø² Ø¨Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…Ú©Ø§Ù„Ù…Ù‡â€ŒØ§ÛŒ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø±ÙˆØ²Ù…Ø±Ù‡. Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø·Ø¨ÛŒØ¹ÛŒ Ùˆ Ù…Ø­Ø§ÙˆØ±Ù‡â€ŒØ§ÛŒ Ø¨Ø§Ø´Ù†Ø¯."
    }
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ Ø³Ø¨Ú© Ù…Ø«Ø§Ù„
    example_style_instructions = {
        "formal": "Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø±Ø³Ù…ÛŒ Ùˆ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ© Ø¨Ø§Ø´Ù†Ø¯.",
        "informal": "Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ ØºÛŒØ±Ø±Ø³Ù…ÛŒ Ùˆ Ù…Ø­Ø§ÙˆØ±Ù‡â€ŒØ§ÛŒ Ø¨Ø§Ø´Ù†Ø¯.",
        "neutral": "Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ùˆ Ø®Ù†Ø«ÛŒ Ø¨Ø§Ø´Ù†Ø¯."
    }
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª
    depth_instructions = {
        "basic": "ØªØ¹Ø±ÛŒÙ Ø³Ø§Ø¯Ù‡ Ùˆ Ù…Ø®ØªØµØ±.",
        "detailed": "ØªØ¹Ø±ÛŒÙ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ± Ùˆ ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÛŒ.",
        "academic": "ØªØ¹Ø±ÛŒÙ Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ© Ùˆ ØªØ®ØµØµÛŒ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¹Ù„Ù…ÛŒ."
    }
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ Ø²Ù…ÛŒÙ†Ù‡
    context_instruction = ""
    if context:
        context_instruction = f"\n\nØ²Ù…ÛŒÙ†Ù‡: Ù‡Ù…Ù‡ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ùˆ ØªØ¹Ø§Ø±ÛŒÙ Ø¨Ø§ÛŒØ¯ Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ø²Ù…ÛŒÙ†Ù‡ '{context}' Ø¨Ø§Ø´Ù†Ø¯."
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ ØªÙ†Ø¸ÛŒÙ… Ø³Ø®ØªÛŒ
    difficulty_instruction = ""
    if difficulty_adjustment:
        if difficulty_adjustment == "easier":
            difficulty_instruction = "\n\nØªÙ†Ø¸ÛŒÙ… Ø³Ø®ØªÛŒ: Ú©Ù„Ù…Ø§Øª Ùˆ ØªØ¹Ø§Ø±ÛŒÙ Ø³Ø§Ø¯Ù‡â€ŒØªØ± Ø§Ø² Ø³Ø·Ø­ Ù…Ø¹Ù…ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯."
        elif difficulty_adjustment == "harder":
            difficulty_instruction = "\n\nØªÙ†Ø¸ÛŒÙ… Ø³Ø®ØªÛŒ: Ú©Ù„Ù…Ø§Øª Ùˆ ØªØ¹Ø§Ø±ÛŒÙ Ù¾ÛŒÚ†ÛŒØ¯Ù‡â€ŒØªØ± Ø§Ø² Ø³Ø·Ø­ Ù…Ø¹Ù…ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯."
    
    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø®ØªÛŒØ§Ø±ÛŒ
    optional_fields = []
    if include_pronunciation:
        optional_fields.append("ØªÙ„ÙØ¸")
    if include_memory_tip:
        optional_fields.append("Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡")
    
    optional_fields_instruction = ""
    if optional_fields:
        optional_fields_instruction = f"\n\nÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø®ØªÛŒØ§Ø±ÛŒ: {', '.join(optional_fields)} Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ Ø´ÙˆÙ†Ø¯."
    else:
        optional_fields_instruction = "\n\nÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø®ØªÛŒØ§Ø±ÛŒ: Ù‡ÛŒÚ† ÙÛŒÙ„Ø¯ Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ù†Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ Ø´ÙˆØ¯."
    
    # ØªØ±Ú©ÛŒØ¨ ØªÙ…Ø§Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§
    prompt_template = f"""
Ø³Ø¨Ú© Ú©Ø§Ø±Øª: {style_instructions.get(card_style, style_instructions['standard'])}
Ø³Ø¨Ú© Ù…Ø«Ø§Ù„: {example_style_instructions.get(example_style, example_style_instructions['neutral'])}
Ø³Ø·Ø­ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ¹Ø±ÛŒÙ: {depth_instructions.get(definition_depth, depth_instructions['basic'])}
ØªØ¹Ø¯Ø§Ø¯ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§: {include_examples}{context_instruction}{difficulty_instruction}{optional_fields_instruction}
"""
    
    return prompt_template
```

#### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªØ¯ [`generate_card`](ai_service/app/providers/openrouter.py:175):

```python
async def generate_card(
    self,
    term: str,
    language: str,
    target_language: str,
    level: str,
    # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
    card_style: str = "standard",
    include_examples: int = 2,
    include_pronunciation: bool = True,
    include_memory_tip: bool = True,
    example_style: str = "neutral",
    definition_depth: str = "basic",
    context: str = None,
    difficulty_adjustment: str = None,
) -> CardGenerationResponse:

    # Ø³Ø§Ø®Øª Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ
    custom_instructions = self._build_prompt_template(
        card_style=card_style,
        include_examples=include_examples,
        include_pronunciation=include_pronunciation,
        include_memory_tip=include_memory_tip,
        example_style=example_style,
        definition_depth=definition_depth,
        context=context,
        difficulty_adjustment=difficulty_adjustment,
        target_language=target_language,
        language=language,
    )

    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ JSON Ø¨Ø± Ø§Ø³Ø§Ø³ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
    json_fields = []
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ
    json_fields.append(f'"definition": "ØªØ¹Ø±ÛŒÙ Ø¯Ø± {target_language}"')
    
    if include_pronunciation:
        json_fields.append(f'"pronunciation": {{"text": "Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙ„ÙØ¸", "hint": null, "tts": {{"text": "{term}", "lang": "{language}"}}}}}')
    
    json_fields.append(f'"part_of_speech": "Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø³ØªÙˆØ±ÛŒ Ø¯Ø± {target_language}"')
    json_fields.append(f'"usage": "Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø¯Ø± {target_language}"')
    
    # Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§
    examples_field = f'"examples": ['
    for i in range(include_examples):
        if i > 0:
            examples_field += ', '
        examples_field += f'{{"text": "Ù…Ø«Ø§Ù„ Ø¯Ø± {language}", "tts": {{"text": "...", "lang": "{language}"}}}}'
    examples_field += ']'
    json_fields.append(examples_field)
    
    if include_memory_tip:
        json_fields.append(f'"memory_tip": "Ù†Ú©ØªÙ‡ Ø­Ø§ÙØ¸Ù‡ Ø¯Ø± {target_language}"')
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø¨Ú© comprehensive
    if card_style == "comprehensive":
        json_fields.append('"synonyms": ["Ù…ØªØ±Ø§Ø¯Ù 1", "Ù…ØªØ±Ø§Ø¯Ù 2"]')
        json_fields.append('"antonyms": ["Ù…ØªØ¶Ø§Ø¯ 1", "Ù…ØªØ¶Ø§Ø¯ 2"]')
        json_fields.append('"etymology": "Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ Ú©Ù„Ù…Ù‡"')
        json_fields.append('"collocations": ["Ø¹Ø¨Ø§Ø±Øª Ø±Ø§ÛŒØ¬ 1", "Ø¹Ø¨Ø§Ø±Øª Ø±Ø§ÛŒØ¬ 2"]')
        json_fields.append('"idioms": ["Ø§ØµØ·Ù„Ø§Ø­ 1"]')
    
    json_structure = ', '.join(json_fields)

    prompt = f'''You are a JSON API. You MUST respond with ONLY valid JSON.

CRITICAL RULES:
1. Start your response with {{ and end with }}
2. Do NOT write any thinking, reasoning, or explanation
3. Do NOT use markdown code blocks
4. Do NOT write anything before or after the JSON

CUSTOM INSTRUCTIONS:
{custom_instructions}

Generate a flashcard for "{term}" in this EXACT format:

{{"front": "{term}", "difficulty": "easy", "back": {{{json_structure}}}}}

INPUT:
- Word: "{term}"
- Level: "{level}"
- Source Language: "{language}"
- Target Language: "{target_language}"

RESPOND WITH JSON ONLY:'''

    logger.info("Generating card for term: '%s' with style: '%s'", term, card_style)
    
    try:
        response = self.client.chat.completions.create(
            model=settings.CEREBRAS_MODEL,
            messages=[
                {"role": "system", "content": "You are a JSON API. You MUST respond with ONLY valid JSON. No thinking, no reasoning, no explanation. Start with { and end with }."},
                {"role": "user", "content": prompt},
            ],
            response_format={"type": "json_object"},
            max_tokens=settings.OPENROUTER_MAX_TOKENS,
            extra_headers={
                "HTTP-Referer": settings.OPENROUTER_REFERER,
                "X-Title": settings.OPENROUTER_SITE_TITLE,
            },
        )

    except openai.RateLimitError as e:
        logger.warning("Rate limit by provider")
        raise APIRateLimitError()

    except openai.APIError as e:
        logger.warning("Open AI error:%s", e)
        raise APIProviderError()

    raw = response.choices[0].message.content.strip()
    logger.info("Raw response: %s", raw)

    raw = re.sub(r'^```(?:json)?\s*', '', raw) 
    raw = re.sub(r'\s*```$', '', raw)
    raw = raw.strip()

    try:
        data = json.loads(raw)
    except json.JSONDecodeError:
        logger.error("Failed to parse AI response as JSON: %s", raw)
        raise InvalidResponseError()

    back_data = data.get("back", {})

    # 1. Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† ØªÙ„ÙØ¸
    pronunciation = None
    pronunciation_data = back_data.get("pronunciation", {})
    if pronunciation_data and include_pronunciation:
        tts = None
        tts_data = pronunciation_data.get("tts")
        if tts_data:
            tts = TTS(
                text=tts_data.get("text", ""),
                lang=tts_data.get("lang", "en-US")
            )
        pronunciation = Pronunciation(
            text=pronunciation_data.get("text", ""),
            hint=pronunciation_data.get("hint", ""),
            tts=tts
        )

    # 2. Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§
    example_list = []
    for ex in back_data.get("examples", []):
        tts = None
        if ex.get("tts"):
            tts = TTS(
                text=ex["tts"].get("text", ""),
                lang=ex["tts"].get("lang", "en-US")
            )
        example_list.append(Example(
            text=ex.get("text", ""),
            tts=tts
        ))
    
    # 3. Ø³Ø§Ø®Øª CardBack Ø¨Ø§ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
    return CardGenerationResponse(
        front=data.get("front", term),
        back=CardBack(
            definition=back_data.get("definition", ""),
            examples=example_list,
            pronunciation=pronunciation,
            part_of_speech=back_data.get("part_of_speech", ""),
            usage=back_data.get("usage", ""),
            memory_tip=back_data.get("memory_tip", "") if include_memory_tip else None,
            # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
            synonyms=back_data.get("synonyms"),
            antonyms=back_data.get("antonyms"),
            etymology=back_data.get("etymology"),
            collocations=back_data.get("collocations"),
            idioms=back_data.get("idioms"),
        ),
        difficulty=data.get("difficulty", "medium"),
    )
```

#### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªØ¯ [`generate_cards_from_topic`](ai_service/app/providers/openrouter.py:31):

```python
async def generate_cards_from_topic(
    self,
    topic: str,
    count: int,
    level: str,
    language: str,
    target_language: str,
    # Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
    card_style: str = "standard",
    include_examples: int = 2,
    include_pronunciation: bool = True,
    include_memory_tip: bool = True,
    example_style: str = "neutral",
    definition_depth: str = "basic",
    context: str = None,
    difficulty_adjustment: str = None,
) -> CardGenerationFromTopicResponse:

    # Ø³Ø§Ø®Øª Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ
    custom_instructions = self._build_prompt_template(
        card_style=card_style,
        include_examples=include_examples,
        include_pronunciation=include_pronunciation,
        include_memory_tip=include_memory_tip,
        example_style=example_style,
        definition_depth=definition_depth,
        context=context,
        difficulty_adjustment=difficulty_adjustment,
        target_language=target_language,
        language=language,
    )

    # Ø³Ø§Ø®Øª Ø¨Ø®Ø´ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ JSON Ø¨Ø± Ø§Ø³Ø§Ø³ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
    json_fields = []
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ
    json_fields.append(f'"definition": "ØªØ¹Ø±ÛŒÙ Ø¯Ø± {target_language}"')
    
    if include_pronunciation:
        json_fields.append(f'"pronunciation": {{"text": "Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙ„ÙØ¸", "hint": null, "tts": {{"text": "word", "lang": "{language}"}}}}}')
    
    json_fields.append(f'"part_of_speech": "noun|verb|adjective|idiom|phrase"')
    json_fields.append(f'"usage": "Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ú©Ù„Ù…Ù‡"')
    
    # Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§
    examples_field = f'"examples": ['
    for i in range(include_examples):
        if i > 0:
            examples_field += ', '
        examples_field += f'{{"text": "Ù…Ø«Ø§Ù„ Ø¬Ù…Ù„Ù‡", "tts": {{"text": "...", "lang": "{language}"}}}}'
    examples_field += ']'
    json_fields.append(examples_field)
    
    if include_memory_tip:
        json_fields.append(f'"memory_tip": "ØªÚ©Ù†ÛŒÚ© Ø­Ø§ÙØ¸Ù‡"')
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø¨Ú© comprehensive
    if card_style == "comprehensive":
        json_fields.append('"synonyms": ["Ù…ØªØ±Ø§Ø¯Ù 1", "Ù…ØªØ±Ø§Ø¯Ù 2"]')
        json_fields.append('"antonyms": ["Ù…ØªØ¶Ø§Ø¯ 1", "Ù…ØªØ¶Ø§Ø¯ 2"]')
        json_fields.append('"etymology": "Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ"')
        json_fields.append('"collocations": ["Ø¹Ø¨Ø§Ø±Øª Ø±Ø§ÛŒØ¬ 1", "Ø¹Ø¨Ø§Ø±Øª Ø±Ø§ÛŒØ¬ 2"]')
        json_fields.append('"idioms": ["Ø§ØµØ·Ù„Ø§Ø­ 1"]')
    
    json_structure = ', '.join(json_fields)

    prompt = f'''You are an expert language learning flashcard generator.

TASK: Generate {count} flashcards about "{topic}" for {level} level learners.

CUSTOM INSTRUCTIONS:
{custom_instructions}

OUTPUT FORMAT: Return ONLY valid JSON with this structure:
{{
    "cards": [
        {{
            "front": "Ú©Ù„Ù…Ù‡ ÛŒØ§ Ø¹Ø¨Ø§Ø±Øª",
            "difficulty": "easy|medium|hard",
            "back": {{{json_structure}}}
        }}
    ]
}}

LEVEL GUIDELINES:
- beginner: Ú©Ù„Ù…Ø§Øª Ø±Ø§ÛŒØ¬ØŒ ØªØ¹Ø§Ø±ÛŒÙ Ø³Ø§Ø¯Ù‡ØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
- intermediate: ÙˆØ§Ú˜Ú¯Ø§Ù† Ø±ÙˆØ²Ù…Ø±Ù‡ØŒ Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ Ù…ØªÙˆØ³Ø·
- advanced: Ú©Ù„Ù…Ø§Øª Ø¢Ú©Ø§Ø¯Ù…ÛŒÚ©ØŒ ØªØ¹Ø§Ø±ÛŒÙ Ø¸Ø±ÛŒÙØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡

QUALITY RULES:
- Ù‡Ø± Ú©Ø§Ø±Øª Ø¨Ø§ÛŒØ¯ ÛŒÚ© Ú©Ù„Ù…Ù‡ UNIQUE Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ (Ø¨Ø¯ÙˆÙ† ØªÚ©Ø±Ø§Ø±)
- Ú©Ù„Ù…Ø§Øª Ø¨Ø§ÛŒØ¯ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ù…Ø±ØªØ¨Ø· Ø¨Ø§ "{topic}" Ø¨Ø§Ø´Ù†Ø¯
- Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø·Ø¨ÛŒØ¹ÛŒ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø¨Ø§Ø´Ù†Ø¯
- ØªØ¹Ø§Ø±ÛŒÙ Ø¯Ø± {target_language}ØŒ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø¯Ø± {language}

Generate {count} unique flashcards now:'''

    logger.info("Generating cards from topic: '%s' with style: '%s'", topic, card_style)
    try:
        response = self.client.chat.completions.create(
            model=settings.CEREBRAS_MODEL,
            messages=[
                {"role": "system", "content": "You are a JSON API. You MUST respond with ONLY valid JSON. No thinking, no reasoning, no explanation. Start with { and end with }."},
                {"role": "user", "content": prompt},
            ],
            response_format={"type": "json_object"},
            max_tokens=settings.OPENROUTER_MAX_TOKENS,
            extra_headers={
                "HTTP-Referer": settings.OPENROUTER_REFERER,
                "X-Title": settings.OPENROUTER_SITE_TITLE,
            },
        )

    except openai.RateLimitError as e:
        logger.warning("Rate limit by provider")
        raise APIRateLimitError()

    except openai.APIError as e:
        logger.warning("Open AI error:%s", e)
        raise APIProviderError()
    
    logger.info("AI response: %s", response)
    raw = response.choices[0].message.content.strip()
    logger.info("Raw Response: %s", raw)

    try:
        data = json.loads(raw)
    except json.JSONDecodeError as e:
        logger.error("Failed to parse AI response as JSON: %s", raw)
        raise InvalidResponseError()

    # Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
    cards = []
    for card_data in data.get("cards", []):
        back_data = card_data.get("back", {})

        # Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† ØªÙ„ÙØ¸
        pronunciation = None
        pronunciation_data = back_data.get("pronunciation", {})
        
        if pronunciation_data and include_pronunciation:
            tts = None
            tts_data = pronunciation_data.get("tts")
            if tts_data:
                tts = TTS(
                    text=tts_data.get("text", ""),
                    lang=tts_data.get("lang", "en-US"),
                )
            pronunciation = Pronunciation(
                text=pronunciation_data.get("text", ""),
                hint=pronunciation_data.get("hint"),
                tts=tts,
            )
        
        # Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§
        example_list = []
        for ex in back_data.get("examples", []):
            tts = TTS(
                text=ex.get("tts", {}).get("text", ""),
                lang=ex.get("tts", {}).get("lang", "en-US"),
            )
            example_list.append(Example(
                text=ex.get("text", ""),
                tts=tts,
            ))
        
        # Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª
        cards.append(CardGenerationResponse(
            front=card_data.get("front", ""),
            back=CardBack(
                definition=back_data.get("definition", ""),
                pronunciation=pronunciation,
                part_of_speech=back_data.get("part_of_speech"),
                usage=back_data.get("usage"),
                examples=example_list,
                memory_tip=back_data.get("memory_tip") if include_memory_tip else None,
                # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                synonyms=back_data.get("synonyms"),
                antonyms=back_data.get("antonyms"),
                etymology=back_data.get("etymology"),
                collocations=back_data.get("collocations"),
                idioms=back_data.get("idioms"),
            ),
            difficulty=card_data.get("difficulty", 'medium')
        ))
    
    return CardGenerationFromTopicResponse(cards=cards)
```

---

## ğŸ§ª ØªØ³Øª Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ

### ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ ÙˆØ§Ø­Ø¯

#### ÙØ§ÛŒÙ„: [`ai_service/tests/test_services/test_card_generation.py`](ai_service/tests/test_services/test_card_generation.py:1)

```python
import pytest
from app.models.request import CardStyle, ExampleStyle, DetailLevel
from app.models.response import CardBack

def test_card_generation_with_custom_style():
    """ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª Ø¨Ø§ Ø³Ø¨Ú© Ø³ÙØ§Ø±Ø´ÛŒ"""
    # ØªØ³Øª Ø¨Ø§ Ø³Ø¨Ú© minimal
    request = CardGenerationRequest(
        term="ephemeral",
        language="en",
        target_language="fa",
        level="beginner",
        card_style=CardStyle.MINIMAL,
        include_examples=1,
        include_pronunciation=False,
        include_memory_tip=False,
    )
    
    # ØªØ³Øª Ø¨Ø§ Ø³Ø¨Ú© comprehensive
    request = CardGenerationRequest(
        term="ephemeral",
        language="en",
        target_language="fa",
        level="advanced",
        card_style=CardStyle.COMPREHENSIVE,
        include_examples=3,
        include_pronunciation=True,
        include_memory_tip=True,
    )

def test_card_back_with_new_fields():
    """ØªØ³Øª ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ CardBack"""
    back = CardBack(
        definition="ØªØ¹Ø±ÛŒÙ",
        synonyms=["Ù…ØªØ±Ø§Ø¯Ù 1", "Ù…ØªØ±Ø§Ø¯Ù 2"],
        antonyms=["Ù…ØªØ¶Ø§Ø¯ 1"],
        etymology="Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ",
        collocations=["Ø¹Ø¨Ø§Ø±Øª 1"],
        idioms=["Ø§ØµØ·Ù„Ø§Ø­ 1"],
    )
    
    assert back.synonyms is not None
    assert len(back.synonyms) == 2
    assert back.antonyms is not None
    assert back.etymology is not None
```

### ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ API

#### ÙØ§ÛŒÙ„: [`ai_service/tests/test_api/test_cards.py`](ai_service/tests/test_api/test_cards.py:1)

```python
def test_generate_card_with_all_options():
    """ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª Ø¨Ø§ ØªÙ…Ø§Ù… Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ"""
    response = client.post(
        "/api/v1/generate-flashcards",
        json={
            "term": "ephemeral",
            "language": "en",
            "target_language": "fa",
            "level": "intermediate",
            "card_style": "comprehensive",
            "include_examples": 3,
            "include_pronunciation": True,
            "include_memory_tip": True,
            "example_style": "formal",
            "definition_depth": "detailed",
            "context": "literature",
            "difficulty_adjustment": "harder",
        },
    )
    
    assert response.status_code == 200
    data = response.json()
    assert data["back"]["synonyms"] is not None
    assert data["back"]["antonyms"] is not None
    assert data["back"]["etymology"] is not None
```

---

## ğŸ“‹ Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

### Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ
- [ ] Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø§Ù…Ù„ Ú©Ø¯ Ù…ÙˆØ¬ÙˆØ¯
- [ ] Ø¯Ø±Ú© Ù…Ø¹Ù…Ø§Ø±ÛŒ Ùˆ Ø¬Ø±ÛŒØ§Ù† Ø¯Ø§Ø¯Ù‡
- [ ] Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø§Ø®Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡

### Ù…Ø±Ø­Ù„Ù‡ Û²: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø¯Ù„â€ŒÙ‡Ø§
- [ ] Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† EnumÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ [`request.py`](ai_service/app/models/request.py:1)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationRequest`](ai_service/app/models/request.py:23)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationFromTopicRequest`](ai_service/app/models/request.py:53)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardBack`](ai_service/app/models/response.py:73) Ø¨Ø§ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯

### Ù…Ø±Ø­Ù„Ù‡ Û³: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³Ø±ÙˆÛŒØ³
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationService.generate_card()`](ai_service/app/services/card_generation_service.py:11)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`CardGenerationService.generate_card_from_topic()`](ai_service/app/services/card_generation_service.py:20)

### Ù…Ø±Ø­Ù„Ù‡ Û´: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ API
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`generate_card()`](ai_service/app/api/v1/cards.py:30) Ø¯Ø± [`cards.py`](ai_service/app/api/v1/cards.py:1)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`generate_card_from_topic()`](ai_service/app/api/v1/cards.py:51) Ø¯Ø± [`cards.py`](ai_service/app/api/v1/cards.py:1)

### Ù…Ø±Ø­Ù„Ù‡ Ûµ: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø±Ø§Ø¦Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡ AI
- [ ] Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ§Ø¨Ø¹ `_build_prompt_template()` Ø¨Ù‡ [`openrouter.py`](ai_service/app/providers/openrouter.py:1)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`generate_card()`](ai_service/app/providers/openrouter.py:175) Ø¯Ø± [`openrouter.py`](ai_service/app/providers/openrouter.py:1)
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ [`generate_cards_from_topic()`](ai_service/app/providers/openrouter.py:31) Ø¯Ø± [`openrouter.py`](ai_service/app/providers/openrouter.py:1)

### Ù…Ø±Ø­Ù„Ù‡ Û¶: ØªØ³Øª
- [ ] Ù†ÙˆØ´ØªÙ† ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ ÙˆØ§Ø­Ø¯ Ø¬Ø¯ÛŒØ¯
- [ ] Ù†ÙˆØ´ØªÙ† ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ API Ø¬Ø¯ÛŒØ¯
- [ ] Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§
- [ ] Ø±ÙØ¹ Ø¨Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯Ù‡

### Ù…Ø±Ø­Ù„Ù‡ Û·: Ù…Ø³ØªÙ†Ø¯Ø³Ø§Ø²ÛŒ
- [ ] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ README
- [ ] Ø§ÙØ²ÙˆØ¯Ù† Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª API
- [ ] Ù…Ø³ØªÙ†Ø¯Ø³Ø§Ø²ÛŒ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯

---

## ğŸ Ù…Ø²Ø§ÛŒØ§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

1. **Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø¨ÛŒØ´ØªØ±**: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù…Ø·Ø§Ø¨Ù‚ Ù†ÛŒØ§Ø² Ø®ÙˆØ¯ Ø³ÙØ§Ø±Ø´ÛŒ Ú©Ù†Ù†Ø¯
2. **Ú©ÛŒÙÛŒØª Ø¨Ù‡ØªØ±**: Ø¨Ø§ Ø²Ù…ÛŒÙ†Ù‡ Ùˆ Ø³Ø¨Ú© Ù…Ø´Ø®ØµØŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±ØªØ¨Ø·â€ŒØªØ± Ùˆ Ù…ÙÛŒØ¯ØªØ± ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
3. **Ú©Ø§Ø±Ø§ÛŒÛŒ Ø¨Ù‡ØªØ±**: Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…Ø¨ØªØ¯ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡â€ŒØªØ± ØªÙˆÙ„ÛŒØ¯ Ú©Ø±Ø¯
4. **Ù¾ÙˆØ´Ø´ Ú¯Ø³ØªØ±Ø¯Ù‡â€ŒØªØ±**: ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ù…Ø«Ù„ Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ Ùˆ Ø±ÛŒØ´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø±Ø§ Ø¹Ù…ÛŒÙ‚â€ŒØªØ± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
5. **ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ù‡ØªØ±**: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ú©Ù†ØªØ±Ù„ Ú©Ø§Ù…Ù„ Ø¨Ø± Ù…Ø­ØªÙˆØ§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¯Ø§Ø±Ù†Ø¯

---

## ğŸ“ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡

### Ù…Ø«Ø§Ù„ Û±: Ú©Ø§Ø±Øª Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ù…Ø¨ØªØ¯ÛŒØ§Ù†

```json
{
  "term": "ephemeral",
  "language": "en",
  "target_language": "fa",
  "level": "beginner",
  "card_style": "minimal",
  "include_examples": 1,
  "include_pronunciation": false,
  "include_memory_tip": false
}
```

### Ù…Ø«Ø§Ù„ Û²: Ú©Ø§Ø±Øª Ø¬Ø§Ù…Ø¹ Ø¨Ø±Ø§ÛŒ Ù…ØªÙˆØ³Ø·Ù‡

```json
{
  "term": "ephemeral",
  "language": "en",
  "target_language": "fa",
  "level": "intermediate",
  "card_style": "comprehensive",
  "include_examples": 3,
  "include_pronunciation": true,
  "include_memory_tip": true,
  "example_style": "neutral",
  "definition_depth": "detailed"
}
```

### Ù…Ø«Ø§Ù„ Û³: Ú©Ø§Ø±Øª Ù…Ú©Ø§Ù„Ù…Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ø²Ù…ÛŒÙ†Ù‡ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±

```json
{
  "term": "ephemeral",
  "language": "en",
  "target_language": "fa",
  "level": "advanced",
  "card_style": "conversational",
  "include_examples": 2,
  "include_pronunciation": true,
  "include_memory_tip": true,
  "example_style": "formal",
  "definition_depth": "academic",
  "context": "business",
  "difficulty_adjustment": "harder"
}
```

### Ù…Ø«Ø§Ù„ Û´: ØªÙˆÙ„ÛŒØ¯ Ú©Ø§Ø±Øª Ø§Ø² Ù…ÙˆØ¶ÙˆØ¹

```json
{
  "topic": "At the end of the day",
  "count": 5,
  "level": "intermediate",
  "language": "en",
  "target_language": "fa",
  "card_style": "standard",
  "include_examples": 2,
  "include_pronunciation": true,
  "include_memory_tip": true,
  "example_style": "informal",
  "definition_depth": "detailed",
  "context": "everyday"
}
```

---

## âš ï¸ Ù†Ú©Ø§Øª Ù…Ù‡Ù…

1. **Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ø¹Ù‚Ø¨**: ØªÙ…Ø§Ù… ØªØºÛŒÛŒØ±Ø§Øª Ø¨Ø§ÛŒØ¯ Ø¨Ø§ API Ù…ÙˆØ¬ÙˆØ¯ Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§Ø´Ù†Ø¯ (Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ù‡Ø³ØªÙ†Ø¯)
2. **Ø¹Ù…Ù„Ú©Ø±Ø¯**: Ø³Ø§Ø®Øª Ù¾Ø±Ø§Ù…Ù¾Øª Ù¾ÙˆÛŒØ§ Ù†Ø¨Ø§ÛŒØ¯ ØªØ£Ø«ÛŒØ± Ù…Ù†ÙÛŒ Ø¨Ø± Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
3. **Ø®Ø·Ø§Ù‡Ø§ÛŒ AI**: Ø¨Ø§ÛŒØ¯ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ Ø§Ø² AI provider Ø­ÙØ¸ Ø´ÙˆØ¯
4. **Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ**: ØªÙ…Ø§Ù… Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø´ÙˆÙ†Ø¯
5. **ØªØ³Øª**: ØªÙ…Ø§Ù… Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ù…Ù…Ú©Ù† Ø¨Ø§ÛŒØ¯ ØªØ³Øª Ø´ÙˆÙ†Ø¯

---

## ğŸ”® Ø¢ÛŒÙ†Ø¯Ù‡â€ŒÙ†Ú¯Ø±ÛŒ

### Ø§Ù…Ú©Ø§Ù†Ø§Øª Ø¢ÛŒÙ†Ø¯Ù‡

1. **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±**: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±
2. **Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª**: Ø§Ù…Ú©Ø§Ù† Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ù„Ø®ÙˆØ§Ù‡ Ú©Ø§Ø±Ø¨Ø±
3. **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù‡ÙˆØ´Ù…Ù†Ø¯**: Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø±
4. **Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ**: Ø§Ù…Ú©Ø§Ù† ØªØ¹Ø±ÛŒÙ Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø³ÙØ§Ø±Ø´ÛŒ
5. **ØªØ­Ù„ÛŒÙ„ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ**: ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ø±Ø§ÛŒÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø±

---

## ğŸ“ ØªÙ…Ø§Ø³

Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ§Ù„Ø§Øª ÛŒØ§ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§ØªØŒ Ù„Ø·ÙØ§Ù‹ Ø¨Ø§ ØªÛŒÙ… ØªÙˆØ³Ø¹Ù‡ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯.

---

**ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯**: Û²Û°Û²Ûµ-Û°Û²-Û²Û³  
**Ù†Ø³Ø®Ù‡**: Û±.Û°  
**ÙˆØ¶Ø¹ÛŒØª**: Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯
